<div class="formulation-container">
  <div class="formulation-form">
    <h2>🧪 AI化粧品処方開発システム</h2>
    <p class="subtitle">市場ニーズに応える新商品企画のための処方をAIが提案します</p>

    <%= form_with(model: @formulation, local: true, html: { class: "cosmetic-form" }) do |f| %>
      <% if @formulation.errors.any? %>
        <div id="error_explanation">
          <h3><%= pluralize(@formulation.errors.count, "個のエラー") %>があります:</h3>
          <ul>
            <% @formulation.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="form-group">
        <%= f.label :product_type, "企画商品タイプ", class: "form-label required" %>
        <%= f.select :product_type, 
            options_for_select([['選択してください', '']] + CosmeticFormulation::PRODUCT_TYPES, @formulation.product_type),
            {}, 
            { class: "form-select", required: true } %>
      </div>

      <div class="form-group">
        <%= f.label :skin_type, "ターゲット肌タイプ", class: "form-label required" %>
        <div class="radio-group">
          <% CosmeticFormulation::SKIN_TYPES.each do |name, value| %>
            <label class="radio-option">
              <%= f.radio_button :skin_type, value, required: true %>
              <span class="radio-label"><%= name %></span>
            </label>
          <% end %>
        </div>
      </div>

      <div class="form-group">
        <%= f.label :concerns, "商品コンセプト・解決したい課題", class: "form-label required" %>
        <%= f.text_area :concerns, 
            class: "form-textarea", 
            rows: 4, 
            placeholder: "例：エイジングケア、美白・シミ対策、毛穴ケア、乾燥対策、ニキビ・肌荒れケア、敏感肌向け低刺激など、ターゲット市場のニーズを具体的にご記入ください。",
            required: true %>
      </div>

      <div class="form-group">
        <%= f.label :target_age, "ターゲット年齢層", class: "form-label required" %>
        <div class="radio-group">
          <% CosmeticFormulation::TARGET_AGES.each do |name, value| %>
            <label class="radio-option">
              <%= f.radio_button :target_age, value, required: true %>
              <span class="radio-label"><%= name %></span>
            </label>
          <% end %>
        </div>
      </div>

      <div class="form-actions">
        <%= f.submit "🚀 AI処方を生成する", class: "btn btn-primary btn-large" %>
        <%= link_to "戻る", cosmetic_formulations_path, class: "btn btn-secondary" %>
      </div>
    <% end %>
  </div>  
</div>
