<!DOCTYPE html>
<html>
  <head>
    <title>BaycosmeSaas</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    
    <!-- Rails UJS for form submission -->
    <script src="https://unpkg.com/@rails/ujs@6.0.0/lib/assets/compiled/rails-ujs.js"></script>
    <script>
      Rails.start();
    </script>
  </head>

  <body>
    <% if user_signed_in? %>
      <!-- SaaS Style Layout with Sidebar -->
      <div class="saas-layout">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
          <div class="sidebar-header">
            <div class="logo">
              <span class="logo-icon">‚ö°</span>
              <span class="logo-text">AI COSMETIC LAB</span>
            </div>
          </div>
          
          <nav class="sidebar-nav">
            <ul class="nav-menu">
              <li class="nav-item">
                <%= link_to dashboard_path, class: "nav-link #{'active' if controller_name == 'users' && action_name == 'show'}" do %>
                  <span class="nav-icon">üè†</span>
                  <span class="nav-text">„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</span>
                <% end %>
              </li>
              
              <li class="nav-item">
                <%= link_to new_cosmetic_formulation_path, class: "nav-link #{'active' if controller_name == 'cosmetic_formulations' && action_name == 'new'}" do %>
                  <span class="nav-icon">üß¨</span>
                  <span class="nav-text">Êñ∞Ë¶èÂá¶Êñπ</span>
                <% end %>
              </li>
              
              <li class="nav-item">
                <%= link_to cosmetic_formulations_path, class: "nav-link #{'active' if controller_name == 'cosmetic_formulations' && action_name == 'index'}" do %>
                  <span class="nav-icon">üìö</span>
                  <span class="nav-text">Âá¶ÊñπÂ±•Ê≠¥</span>
                <% end %>
              </li>
              
              <li class="nav-item">
                <%= link_to edit_user_registration_path, class: "nav-link #{'active' if controller_name == 'registrations' && action_name == 'edit'}" do %>
                  <span class="nav-icon">‚öôÔ∏è</span>
                  <span class="nav-text">Ë®≠ÂÆö</span>
                <% end %>
              </li>
            </ul>
            
            <div class="sidebar-footer">
              <div class="user-info">
                <div class="user-avatar">
                  <div class="avatar-placeholder">üë§</div>
                </div>
                <div class="user-details">
                  <div class="user-name"><%= current_user.display_name %></div>
                  <div class="user-email"><%= current_user.email %></div>
                </div>
              </div>
              
              <%= link_to destroy_user_session_path, data: { method: :delete, confirm: "„É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åæ„Åô„ÅãÔºü" }, class: "logout-btn" do %>
                <span class="nav-icon">üö™</span>
                <span class="nav-text">„É≠„Ç∞„Ç¢„Ç¶„Éà</span>
              <% end %>
            </div>
          </nav>
        </div>
        
        <!-- Main Content Area -->
        <div class="main-content">
          <!-- Top Header for logged-in users -->
          <div class="top-header">
            <div class="header-left">
              <h1 class="page-title">
                <% case controller_name %>
                <% when 'users' %>
                  <% if action_name == 'show' %>
                    üè† „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ
                  <% elsif action_name == 'edit' %>
                    ‚öôÔ∏è „Éó„É≠„Éï„Ç£„Éº„É´Ë®≠ÂÆö
                  <% end %>
                <% when 'cosmetic_formulations' %>
                  <% if action_name == 'new' %>
                    üß¨ Êñ∞„Åó„ÅÑÂá¶Êñπ„Çí‰ΩúÊàê
                  <% elsif action_name == 'index' %>
                    üìö Âá¶ÊñπÂ±•Ê≠¥
                  <% elsif action_name == 'show' %>
                    üß™ Âá¶ÊñπË©≥Á¥∞
                  <% end %>
                <% when 'home' %>
                  üè† „Éõ„Éº„É†
                <% else %>
                  ‚ö° AI COSMETIC LAB
                <% end %>
              </h1>
            </div>
            
            <div class="header-right">
              <div class="profile-completion">
                <span class="completion-label">ÂÆåÊàêÂ∫¶:</span>
                <span class="completion-percentage"><%= current_user.profile_completion_percentage %>%</span>
                <div class="completion-bar">
                  <div class="completion-fill" style="width: <%= current_user.profile_completion_percentage %>%;"></div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Content Area -->
          <div class="content-area">
            <% if notice %>
              <div class="notice"><%= notice %></div>
            <% end %>
            <% if alert %>
              <div class="alert"><%= alert %></div>
            <% end %>
            
            <%= yield %>
          </div>
        </div>
      </div>
    <% else %>
      <!-- Guest Layout (No Sidebar) -->
      <div class="guest-layout">
        <% if notice %>
          <p class="notice"><%= notice %></p>
        <% end %>
        <% if alert %>
          <p class="alert"><%= alert %></p>
        <% end %>
        
        <%= yield %>
      </div>
    <% end %>
  </body>
</html>
